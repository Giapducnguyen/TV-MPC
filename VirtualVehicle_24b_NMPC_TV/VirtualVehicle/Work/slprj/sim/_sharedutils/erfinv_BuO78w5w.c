#include "rtwtypes.h"
#include "erfinv_BuO78w5w.h"
#include "mwmathutil.h"
#include <math.h>
#include "rt_nonfinite.h"

real_T erfinv_BuO78w5w(real_T y)
{
  real_T R;
  real_T b_z;
  real_T s;
  real_T x;
  real_T z;
  int32_T b;
  int32_T eint;
  if (muDoubleScalarIsNaN(y)) {
    x = (rtNaN);
  } else {
    z = muDoubleScalarSqrt(-muDoubleScalarLog((1.0 - y) / 2.0));
    x = (((1.641345311 * z + 3.429567803) * z - 1.624906493) * z - 1.970840454) /
      ((1.6370678 * z + 3.5438892) * z + 1.0);

    /* ========================== COPYRIGHT NOTICE ============================ */
    /*  The algorithms for calculating ERF(X) and ERFC(X) are derived           */
    /*  from FDLIBM, which has the following notice:                            */
    /*                                                                          */
    /*  Copyright (C) 1993 by Sun Microsystems, Inc. All rights reserved.       */
    /*                                                                          */
    /*  Developed at SunSoft, a Sun Microsystems, Inc. business.                */
    /*  Permission to use, copy, modify, and distribute this                    */
    /*  software is freely granted, provided that this notice                   */
    /*  is preserved.                                                           */
    /* =============================    END    ================================ */
    z = muDoubleScalarAbs(x);
    if (muDoubleScalarIsNaN(x)) {
      z = (rtNaN);
    } else if (muDoubleScalarIsInf(x)) {
      if (x < 0.0) {
        z = 2.0;
      } else {
        z = 0.0;
      }
    } else if (z < 0.84375) {
      if (z < 1.3877787807814457E-17) {
        z = 1.0 - x;
      } else {
        b_z = x * x;
        if (x < 0.25) {
          z = 1.0 - (((((b_z * -2.3763016656650163E-5 - 0.0057702702964894416) *
                        b_z - 0.02848174957559851) * b_z - 0.3250421072470015) *
                      b_z + 0.12837916709551256) / (((((b_z *
            -3.9602282787753681E-6 + 0.00013249473800432164) * b_z +
            0.0050813062818757656) * b_z + 0.0650222499887673) * b_z +
            0.39791722395915535) * b_z + 1.0) * x + x);
        } else {
          z = 0.5 - (((((b_z * -2.3763016656650163E-5 - 0.0057702702964894416) *
                        b_z - 0.02848174957559851) * b_z - 0.3250421072470015) *
                      b_z + 0.12837916709551256) / (((((b_z *
            -3.9602282787753681E-6 + 0.00013249473800432164) * b_z +
            0.0050813062818757656) * b_z + 0.0650222499887673) * b_z +
            0.39791722395915535) * b_z + 1.0) * x + (x - 0.5));
        }
      }
    } else if (z < 1.25) {
      if (x >= 0.0) {
        z = 0.15493708848953247 - (((((((z - 1.0) * -0.0021663755948687908 +
          0.035478304325618236) * (z - 1.0) - 0.11089469428239668) * (z - 1.0) +
          0.31834661990116175) * (z - 1.0) - 0.37220787603570132) * (z - 1.0) +
          0.41485611868374833) * (z - 1.0) - 0.0023621185607526594) / (((((((z -
          1.0) * 0.011984499846799107 + 0.013637083912029051) * (z - 1.0) +
          0.12617121980876164) * (z - 1.0) + 0.071828654414196266) * (z - 1.0) +
          0.540397917702171) * (z - 1.0) + 0.10642088040084423) * (z - 1.0) +
          1.0);
      } else {
        z = ((((((((z - 1.0) * -0.0021663755948687908 + 0.035478304325618236) *
                  (z - 1.0) - 0.11089469428239668) * (z - 1.0) +
                 0.31834661990116175) * (z - 1.0) - 0.37220787603570132) * (z -
                1.0) + 0.41485611868374833) * (z - 1.0) - 0.0023621185607526594)
             / (((((((z - 1.0) * 0.011984499846799107 + 0.013637083912029051) *
                    (z - 1.0) + 0.12617121980876164) * (z - 1.0) +
                   0.071828654414196266) * (z - 1.0) + 0.540397917702171) * (z -
                1.0) + 0.10642088040084423) * (z - 1.0) + 1.0) +
             0.84506291151046753) + 1.0;
      }
    } else if (x < -6.0) {
      z = 2.0;
    } else if (x >= 28.0) {
      z = 0.0;
    } else {
      s = 1.0 / (z * z);
      if (z < 2.8571414947509766) {
        R = ((((((s * -9.8143293441691455 - 81.2874355063066) * s -
                 184.60509290671104) * s - 162.39666946257347) * s -
               62.375332450326006) * s - 10.558626225323291) * s -
             0.69385857270718176) * s - 0.0098649440348471482;
        s = (((((((s * -0.0604244152148581 + 6.5702497703192817) * s +
                  108.63500554177944) * s + 429.00814002756783) * s +
                645.38727173326788) * s + 434.56587747522923) * s +
              137.65775414351904) * s + 19.651271667439257) * s + 1.0;
      } else {
        R = (((((s * -483.5191916086514 - 1025.0951316110772) * s -
                637.56644336838963) * s - 160.63638485582192) * s -
              17.757954917754752) * s - 0.799283237680523) * s -
          0.0098649429247001;
        s = ((((((s * -22.440952446585818 + 474.52854120695537) * s +
                 2553.0504064331644) * s + 3199.8582195085955) * s +
               1536.729586084437) * s + 325.79251299657392) * s +
             30.338060743482458) * s + 1.0;
      }

      if ((!muDoubleScalarIsInf(z)) && (!muDoubleScalarIsNaN(z))) {
        b_z = frexp(z, &eint);
        b = eint;
      } else {
        b_z = z;
        b = 0;
      }

      b_z = muDoubleScalarFloor(b_z * 2.097152E+6) / 2.097152E+6 *
        muDoubleScalarPower(2.0, b);
      z = muDoubleScalarExp((b_z - z) * (b_z + z) + R / s) * muDoubleScalarExp
        (-b_z * b_z - 0.5625) / z;
      if (x < 0.0) {
        z = 2.0 - z;
      }
    }

    z = -(z - (1.0 - y)) / (muDoubleScalarExp(-x * x) * 1.1283791670955126);
    x -= z / (x * z + 1.0);

    /* ========================== COPYRIGHT NOTICE ============================ */
    /*  The algorithms for calculating ERF(X) and ERFC(X) are derived           */
    /*  from FDLIBM, which has the following notice:                            */
    /*                                                                          */
    /*  Copyright (C) 1993 by Sun Microsystems, Inc. All rights reserved.       */
    /*                                                                          */
    /*  Developed at SunSoft, a Sun Microsystems, Inc. business.                */
    /*  Permission to use, copy, modify, and distribute this                    */
    /*  software is freely granted, provided that this notice                   */
    /*  is preserved.                                                           */
    /* =============================    END    ================================ */
    z = muDoubleScalarAbs(x);
    if (muDoubleScalarIsNaN(x)) {
      z = (rtNaN);
    } else if (muDoubleScalarIsInf(x)) {
      if (x < 0.0) {
        z = 2.0;
      } else {
        z = 0.0;
      }
    } else if (z < 0.84375) {
      if (z < 1.3877787807814457E-17) {
        z = 1.0 - x;
      } else {
        b_z = x * x;
        if (x < 0.25) {
          z = 1.0 - (((((b_z * -2.3763016656650163E-5 - 0.0057702702964894416) *
                        b_z - 0.02848174957559851) * b_z - 0.3250421072470015) *
                      b_z + 0.12837916709551256) / (((((b_z *
            -3.9602282787753681E-6 + 0.00013249473800432164) * b_z +
            0.0050813062818757656) * b_z + 0.0650222499887673) * b_z +
            0.39791722395915535) * b_z + 1.0) * x + x);
        } else {
          z = 0.5 - (((((b_z * -2.3763016656650163E-5 - 0.0057702702964894416) *
                        b_z - 0.02848174957559851) * b_z - 0.3250421072470015) *
                      b_z + 0.12837916709551256) / (((((b_z *
            -3.9602282787753681E-6 + 0.00013249473800432164) * b_z +
            0.0050813062818757656) * b_z + 0.0650222499887673) * b_z +
            0.39791722395915535) * b_z + 1.0) * x + (x - 0.5));
        }
      }
    } else if (z < 1.25) {
      if (x >= 0.0) {
        z = 0.15493708848953247 - (((((((z - 1.0) * -0.0021663755948687908 +
          0.035478304325618236) * (z - 1.0) - 0.11089469428239668) * (z - 1.0) +
          0.31834661990116175) * (z - 1.0) - 0.37220787603570132) * (z - 1.0) +
          0.41485611868374833) * (z - 1.0) - 0.0023621185607526594) / (((((((z -
          1.0) * 0.011984499846799107 + 0.013637083912029051) * (z - 1.0) +
          0.12617121980876164) * (z - 1.0) + 0.071828654414196266) * (z - 1.0) +
          0.540397917702171) * (z - 1.0) + 0.10642088040084423) * (z - 1.0) +
          1.0);
      } else {
        z = ((((((((z - 1.0) * -0.0021663755948687908 + 0.035478304325618236) *
                  (z - 1.0) - 0.11089469428239668) * (z - 1.0) +
                 0.31834661990116175) * (z - 1.0) - 0.37220787603570132) * (z -
                1.0) + 0.41485611868374833) * (z - 1.0) - 0.0023621185607526594)
             / (((((((z - 1.0) * 0.011984499846799107 + 0.013637083912029051) *
                    (z - 1.0) + 0.12617121980876164) * (z - 1.0) +
                   0.071828654414196266) * (z - 1.0) + 0.540397917702171) * (z -
                1.0) + 0.10642088040084423) * (z - 1.0) + 1.0) +
             0.84506291151046753) + 1.0;
      }
    } else if (x < -6.0) {
      z = 2.0;
    } else if (x >= 28.0) {
      z = 0.0;
    } else {
      s = 1.0 / (z * z);
      if (z < 2.8571414947509766) {
        R = ((((((s * -9.8143293441691455 - 81.2874355063066) * s -
                 184.60509290671104) * s - 162.39666946257347) * s -
               62.375332450326006) * s - 10.558626225323291) * s -
             0.69385857270718176) * s - 0.0098649440348471482;
        s = (((((((s * -0.0604244152148581 + 6.5702497703192817) * s +
                  108.63500554177944) * s + 429.00814002756783) * s +
                645.38727173326788) * s + 434.56587747522923) * s +
              137.65775414351904) * s + 19.651271667439257) * s + 1.0;
      } else {
        R = (((((s * -483.5191916086514 - 1025.0951316110772) * s -
                637.56644336838963) * s - 160.63638485582192) * s -
              17.757954917754752) * s - 0.799283237680523) * s -
          0.0098649429247001;
        s = ((((((s * -22.440952446585818 + 474.52854120695537) * s +
                 2553.0504064331644) * s + 3199.8582195085955) * s +
               1536.729586084437) * s + 325.79251299657392) * s +
             30.338060743482458) * s + 1.0;
      }

      if ((!muDoubleScalarIsInf(z)) && (!muDoubleScalarIsNaN(z))) {
        b_z = frexp(z, &eint);
        b = eint;
      } else {
        b_z = z;
        b = 0;
      }

      b_z = muDoubleScalarFloor(b_z * 2.097152E+6) / 2.097152E+6 *
        muDoubleScalarPower(2.0, b);
      z = muDoubleScalarExp((b_z - z) * (b_z + z) + R / s) * muDoubleScalarExp
        (-b_z * b_z - 0.5625) / z;
      if (x < 0.0) {
        z = 2.0 - z;
      }
    }

    z = -(z - (1.0 - y)) / (muDoubleScalarExp(-x * x) * 1.1283791670955126);
    x -= z / (x * z + 1.0);
  }

  return x;
}
